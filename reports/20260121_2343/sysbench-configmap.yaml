apiVersion: v1
data:
  sysbench-cleanup.sh: |
    #!/bin/bash
    set -e

    # Sysbench cleanup script - generated from Helm values

    echo "=== Sysbench Cleanup ==="
    echo "Dropping benchmark tables..."
    echo ""

    exec sysbench oltp_read_write \
      --db-driver=pgsql \
      --pgsql-host=yb-tserver-service \
      --pgsql-port=5433 \
      --pgsql-user=yugabyte \
      --pgsql-password=yugabyte \
      --pgsql-db=yugabyte \
      --tables=20 \
      --table_size=5000000 \
      cleanup
  sysbench-prepare.sh: |
    #!/bin/bash
    set -e

    # Sysbench prepare script - generated from Helm values
    # Parameters follow YugabyteDB docs: https://docs.yugabyte.com/stable/benchmark/sysbench-ysql/

    echo "=== Sysbench Prepare ==="
    echo "Workload: oltp_read_write"
    echo "Tables: 20 x 5000000 rows"
    echo ""

    exec sysbench oltp_read_write \
      --db-driver=pgsql \
      --pgsql-host=yb-tserver-service \
      --pgsql-port=5433 \
      --pgsql-user=yugabyte \
      --pgsql-password=yugabyte \
      --pgsql-db=yugabyte \
      --tables=20 \
      --table_size=5000000 \
      --range_key_partitioning=false \
      --serial_cache_size=1000 \
      --create_secondary=true \
      prepare
  sysbench-run.sh: |
    #!/bin/bash
    set -e

    # Sysbench run script - generated from Helm values
    # Parameters follow YugabyteDB docs: https://docs.yugabyte.com/stable/benchmark/sysbench-ysql/

    echo "=== Sysbench Benchmark ==="
    echo "Workload: oltp_read_write"
    echo "Threads: 120"
    echo "Duration: 1800s (warmup: 300s)"
    echo ""

    # CRITICAL: range_selects=false prevents 100x slowdown from cross-tablet scans
    exec sysbench oltp_read_write \
      --db-driver=pgsql \
      --pgsql-host=yb-tserver-service \
      --pgsql-port=5433 \
      --pgsql-user=yugabyte \
      --pgsql-password=yugabyte \
      --pgsql-db=yugabyte \
      --tables=20 \
      --table_size=5000000 \
      --range_key_partitioning=false \
      --serial_cache_size=1000 \
      --create_secondary=true \
      --range_selects=false \
      --point_selects=10 \
      --index_updates=10 \
      --non_index_updates=10 \
      --num_rows_in_insert=10 \
      --thread-init-timeout=90 \
      --threads=120 \
      --time=1800 \
      --warmup-time=300 \
      --report-interval=10 \
      run
kind: ConfigMap
metadata:
  annotations:
    meta.helm.sh/release-name: yb-bench
    meta.helm.sh/release-namespace: yugabyte-test
  creationTimestamp: "2026-01-21T22:11:58Z"
  labels:
    app.kubernetes.io/component: sysbench
    app.kubernetes.io/instance: yb-bench
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: yb-benchmark
    app.kubernetes.io/version: 1.0.0
    helm.sh/chart: yb-benchmark-0.1.0
  name: yb-bench-sysbench-scripts
  namespace: yugabyte-test
  resourceVersion: "22848"
  uid: cb4577ce-6705-46f3-ad32-ef186cdaf6ec
