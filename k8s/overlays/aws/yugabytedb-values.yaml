# YugabyteDB Helm values for AWS (kube-sandbox testing)
# Cluster: 3 x c6i.2xlarge (tservers) + 1 x t3.2xlarge (masters/others)

replicas:
  master: 3
  tserver: 3

resource:
  master:
    requests:
      cpu: "1"
      memory: "4Gi"
    limits:
      cpu: "2"
      memory: "8Gi"
  tserver:
    requests:
      cpu: "6"
      memory: "15Gi"
    limits:
      cpu: "8"
      memory: "16Gi"

# Node affinity to place tservers on c6i.2xlarge nodes (worker1-3)
tserver:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: role
                operator: In
                values:
                  - worker1
                  - worker2
                  - worker3

# Place masters on t3.2xlarge node (worker4)
master:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: role
                operator: In
                values:
                  - worker4

storage:
  master:
    storageClass: ebs-gp3
    size: 10Gi
  tserver:
    storageClass: ebs-gp3
    size: 50Gi

enableLoadBalancer: true

# ClusterIP service for load-balanced YSQL connections
serviceEndpoints:
  - name: yb-tserver-service
    type: ClusterIP
    app: yb-tserver
    ports:
      tcp-ysql-port: "5433"

ysql:
  enabled: true
  port: 5433

ycql:
  enabled: false

metrics:
  enabled: true

# Cluster settings
gflags:
  master:
    replication_factor: 3
  tserver:
    yb_num_shards_per_tserver: 4
    ysql_num_shards_per_tserver: 4
